
var API = {};

// -- factory for generating API calls based on type and url
var method = function(method, url, terms) {

    var ajaxOpts = {
        type: method,
        url: url,
        dataType: "json",
        contentType: "application/json",
        processData: false
    };
    var dataFn = JSON.stringify;
    if (method == "GET") {
        dataFn = _.identity;
        ajaxOpts = {
            type: method,
            url: url
        };
    }

    // -- this is the real signature of the API calls
    return function(options, doneCallback, errorCallback) {

        ajaxOpts.data = dataFn(options);

       // console.log(ajaxOpts);
        $.ajax(ajaxOpts).done(function(data) {
            if (!doneCallback) {
                return;
            }
            data.request = options;
            doneCallback(data);
        }).error(errorCallback);
    };
};

API.action = method("POST", "/api/action");
API.getKinds = method("GET", "/api/kinds");
API.login = method("POST", "/api/login");
API.logout = method("POST", "/api/logout");
API.register = method("POST", "/api/register");
API.getUsers = method("GET", "/api/users");
API.newCorpus = method("POST", "/api/newcorpus");
API.updateUserSettings = method("POST", "/api/updatesettings");
API.getNotes = method("POST", "/store/annotations/search");
API.getNoteHistory = method("POST", "/api/notehistory");
API.getActivityLog = method("POST", "/api/activitylog");
API.getResourcesInCorpus = method("POST", "/api/resourcesincorpus");
API.updateSubcorpora = method("POST", "/api/updatesubcorpora");
API.voteForResource = method("POST", "/api/resourcevote");

